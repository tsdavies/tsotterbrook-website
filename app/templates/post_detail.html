{% extends "layout.html" %} {% block content %}
<main class="container my-5">
  <!-- Post Title and Content -->
  <div class="mb-4">
    <h1 class="text-center">{{ post.title }}</h1>
    <p class="text-muted text-center">
      By {{ post.author or 'Anonymous' }} on {{ post.timestamp }}
    </p>
    <p class="lead">{{ post.content }}</p>
  </div>

  <!-- Edit and Delete Buttons -->
  <div class="text-center mb-4">
    <a
      href="{{ url_for('edit_post', post_id=post.id) }}"
      class="btn btn-warning me-2"
    >
      <i class="bi bi-pencil-square"></i> Edit Post
    </a>
    <a
      href="{{ url_for('delete_post', post_id=post.id) }}"
      class="btn btn-danger"
      onclick="return confirm('Are you sure you want to delete this post?');"
    >
      <i class="bi bi-trash"></i> Delete Post
    </a>
  </div>

  <hr />

  <!-- Comments Section -->
  <div class="comments-section">
    <h2 class="mb-4">Comments</h2>

    {% if post.comments and post.comments|length > 0 %}
    <ul class="list-group">
      {% for comment in post.comments %}
      <li
        class="list-group-item d-flex justify-content-between align-items-center"
      >
        <span>
          {{ comment.content }} -
          <strong>{{ comment.author or 'Anonymous' }}</strong>
        </span>
        <a
          href="{{ url_for('delete_comment', comment_id=comment.id) }}"
          class="btn btn-sm btn-outline-danger"
          onclick="return confirm('Are you sure you want to delete this comment?');"
        >
          <i class="bi bi-x-circle"></i> Delete
        </a>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p class="text-muted">No comments yet. Be the first to comment!</p>
    {% endif %}
  </div>

  <hr />

  <!-- Add a Comment Form -->
  <div class="add-comment">
    <h3 class="mb-3">Add a Comment</h3>
    <form
      class="needs-validation"
      novalidate
      method="POST"
      action="{{ url_for('post_detail', post_id=post.id) }}"
    >
      {{ form.hidden_tag() }}

      <!-- Comment Content -->
      <div class="mb-3">
        {{ form.content.label(class="form-label") }} {{
        form.content(class="form-control", size=50) }}
        <div class="invalid-feedback">Please enter your comment.</div>
      </div>

      <!-- Author -->
      <div class="mb-3">
        {{ form.author.label(class="form-label") }} {{
        form.author(class="form-control", size=20) }}
        <div class="invalid-feedback">Please enter your name.</div>
      </div>

      <!-- Submit Button -->
      <div class="text-center">{{ form.submit(class="btn btn-primary") }}</div>
    </form>
  </div>
</main>
{% endblock %}
